## This is to generate random networks and determine their modularity
library(bct)
Args <- Sys.getenv("R_ARGS")
ss <- noquote(strsplit(Args," ")[[1]][1])
Cond <- as.numeric(noquote(strsplit(Args," ")[[1]][2]))
input_links <- paste("cleanTS.",Cond,".",ss,"_graymask_dump.bin.corr.thresh.links",sep="")
out_random_links <- paste("rand.",Cond,".",ss,".links",sep="")
setwd(paste(Sys.getenv("state"),"/",ss,"/corrTRIM_BLUR/",sep=""))
rand_bin_und(input_links,out_random_links,.9)

#.Call("main_convert",'rand.1.links','rand.1.srcdst',PACKAGE='bct')
#modularity_score = blondel_community("rand.1.srcdst","rand.1.tree")
random_srcdst <- paste("rand.",Cond,".",ss,".srcdst",sep="")
.Call("main_convert",out_random_links,random_srcdst,PACKAGE='bct')
modularity_score = blondel_community(random_srcdst,paste("rand.",Cond,".",ss,".tree",sep=""))
write.table(modularity_score, paste("rand.",Cond,".",ss,".mod_score",sep=""), row.names=F, col.names=F, quote=F)
